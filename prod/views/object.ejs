<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image" href="Logos/logo_FDE.svg">
    <link rel="stylesheet" href="css/style2.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chart.js et adaptateur date -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <title>FDE : Accueil</title>
</head>
<body>
    <div class="wrapper">
        <%- include('partials/header') %>
        <main>
            <%- include('account_icon_bar.html'); %>
            <div class="container">
                <div class="form-box">
                    <div class="login-container" id="modify-account">
                        <fieldset>
                            <header>Informations sur <%= obj.name %></header>
                            <form>
                                <div class="input-box">
                                    <div>Nom</div>
                                    <div class="info-field" id="display"><%= obj.name %></div>
                                </div>
                                <div class="input-box">
                                    <div>Type</div>
                                    <div class="info-field" id="display"><%= obj.type %></div>
                                </div>
                                <div class="input-box">
                                    <div>Region</div>
                                    <div class="info-field" id="display"><%= region[0].name %></div>
                                </div>
                            </form>
                        </fieldset>
                        <canvas id="myChart" style="width:100%; background-color: rgba(255,255,255,0.5); border-radius: 5px; padding: 5px;"></canvas>
                            <script>
                                const dataFromServer = <%- JSON.stringify(data) %>;
    
                                const ctx = document.getElementById('myChart').getContext('2d');
                                const myChart = new Chart(ctx, {
                                    type: 'line',
                                    data: {
                                        datasets: [{
                                            label: "<%= obj.name %>",
                                            data: dataFromServer.map(item => ({
                                                x: new Date(item.date),
                                                y: item.value
                                            })),
                                            fill: false,
                                            borderColor: 'rgba(54, 162, 235, 1)',
                                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                            tension: 0.1
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        elements: {
                                            line: { spanGaps: true }
                                        },
                                        scales: {
                                            x: {
                                                type: 'time',
                                                time: {
                                                    unit: 'day',
                                                    displayFormats: {
                                                        day: 'dd/MM/yyyy'
                                                    }
                                                },
                                                title: {
                                                    display: true,
                                                    text: 'Date'
                                                }
                                            },
                                            y: {
                                                title: {
                                                    display: true,
                                                    text: 'Production (kWh)' // Ajuste selon ta valeur
                                                }
                                            }
                                        }
                                    }
                                });
                            </script>
                    </div>
                </div>
            </div>
            <a href="/objectSearch">← Retour à la recherche</a>
        </main>
    </div>
</body>
</html>
